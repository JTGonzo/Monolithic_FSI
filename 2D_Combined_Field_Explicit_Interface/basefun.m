function [psi,psi_x,psi_y]=basefun(deg,x,y)
% Base function has the name specifies this functions gives you with base
% function....and at this point lagrangian functions upto degree 5 are
% being availble...

zeroRow=zeros(1,length(x));
oneRow=ones(1,length(x));
switch deg
    case 1
        psi=[1-x-y
            x
            y].';
        psi_x=[-oneRow
            oneRow
            zeroRow].';
        psi_y=[-oneRow
            zeroRow
            oneRow].';
    case 2
        psi=[ (2*x+2*y-2).*(x+y-1/2),
            2*x.*(x-1/2),
            2*y.*(y-1/2),
            4*x.*y,
            (-4*x-4*y+4).*y,
            -4*x.*(x+y-1)].';
        psi_x=[4*x+4*y-3,
            4*x-1,
            zeroRow,
            4*y,
            -4*y,
            -8*x-4*y+4].';
        psi_y=[4*x+4*y-3,
            zeroRow,
            4*y-1,
            4*x,
            -8*y-4*x+4,
            -4*x].';
    case 3
        psi= [
            -9/2.*(x+y-1/3).*(x+y-2/3).*(x+y-1)
            9/2.*x.*(x-1/3).*(x-2/3)
            9/2.*y.*(y-1/3).*(y-2/3)
            27/2.*x.*y.*(x-1/3)
            -27/2.*y.*(y-1/3).*(x+y-1)
            27/2.*x.*(x+y-2/3).*(x+y-1)
            27/2.*x.*y.*(y-1/3)
            27/2.*y.*(x+y-2/3).*(x+y-1)
            -27/2.*x.*(x-1/3).*(x+y-1)
            -27.*x.*y.*(x+y-1)].';
        
        psi_x=[ 
            -27/2*x.^2-27*x.*y+18*x-27/2*y.^2+18*y-11/2
            27/2*x.^2-9*x+1
            zeroRow
            9/2*y.*(6*x-1)
            -9/2*y.*(3*y-1)
            81/2*x.^2+54*x.*y-45*x+27/2*y.^2-45/2*y+9
            9/2*y.*(3*y-1)
            9/2*y.*(6*x+6*y-5)
            -81/2*x.^2-27*x.*y+36*x+9/2*y-9/2
            -27*y.*(2*x+y-1)].';
        
        psi_y=[
            -27/2*x.^2-27*x.*y+18*x-27/2*y.^2+18*y-11/2
            zeroRow
            27/2*y.^2-9*y+1
            9/2*x.*(3*x-1)
            -27*x.*y-81/2*y.^2+36*y+9/2*x-9/2
            9/2*x.*(6*x+6*y-5)
            9/2*x.*(6*y-1)
            27/2*x.^2+54*x.*y-45/2*x+81/2*y.^2-45*y+9
            -9/2*x.*(3*x-1)
            -27*x.*(x+2*y-1)].';
    case 4
        psi = [
            1/3.*(x+y-1).*(4.*x+4.*y-3).*(2.*x+2.*y-1).*(4.*x+4.*y-1)
            1/3.*x.*(4.*x-1).*(2.*x-1).*(4.*x-3)
            1/3.*y.*(4.*y-1).*(2.*y-1).*(4.*y-3)
            4.*x.*(4.*x-1).*y.*(4.*y-1)
            4.*y.*(4.*y-1).*(4.*x+4.*y-3).*(x+y-1)
            4.*x.*(4.*x-1).*(4.*x+4.*y-3).*(x+y-1)
            16/3.*x.*(4.*x-1).*(2.*x-1).*y
            -16/3.*y.*(4.*y-1).*(2.*y-1).*(x+y-1)
            -16/3.*x.*(2.*x+2.*y-1).*(4.*x+4.*y-3).*(x+y-1)
            16/3.*x.*y.*(4.*y-1).*(2.*y-1)
            -16/3.*y.*(2.*x+2.*y-1).*(4.*x+4.*y-3).*(x+y-1)
            -16/3.*x.*(4.*x-1).*(2.*x-1).*(x+y-1)
            32.*x.*y.*(4.*x+4.*y-3).*(x+y-1)
            -32.*x.*(4.*x-1).*y.*(x+y-1)
            -32.*x.*y.*(4.*y-1).*(x+y-1)].';
        
        psi_x = [
            1/3.*(8.*x-5+8.*y).*(16.*x.^2-20.*x+32.*y.*x-20.*y+16.*y.^2+5)
            1/3.*(8.*x-3).*(16.*x.^2-12.*x+1)
            zeroRow
            4.*y.*(4.*y-1).*(8.*x-1)
            4.*y.*(4.*y-1).*(8.*x+8.*y-7)
            4.*(2.*x+y-1).*(32.*y.*x-4.*y-32.*x+32.*x.^2+3)
            16/3.*y.*(24.*x.^2-12.*x+1)
            -16/3.*y.*(4.*y-1).*(2.*y-1)
            16-416/3.*x-208/3.*y+384.*y.*x-384.*y.*x.^2-128/3.*y.^3-512/3.*x.^3+288.*x.^2+96.*y.^2-256.*y.^2.*x
            16/3.*y.*(4.*y-1).*(2.*y-1)
            -16/3.*y.*(24.*x.^2+48.*y.*x-36.*x+24.*y.^2-36.*y+13)
            -512/3.*x.^3-128.*y.*x.^2+224.*x.^2+64.*y.*x-224/3.*x-16/3.*y+16/3
            32.*y.*(12.*x.^2+16.*y.*x-14.*x+4.*y.^2-7.*y+3)
            -32.*y.*(12.*x.^2+8.*y.*x-10.*x-y+1)
            -32.*y.*(4.*y-1).*(2.*x+y-1)].';

        psi_y = [
            1/3.*(8.*x-5+8.*y).*(16.*x.^2-20.*x+32.*y.*x-20.*y+16.*y.^2+5)
            zeroRow
            1/3.*(8.*y-3).*(16.*y.^2-12.*y+1)
            4.*x.*(8.*y-1).*(4.*x-1)
            4.*(x+2.*y-1).*(32.*y.*x-4.*x+32.*y.^2+3-32.*y)
            4.*x.*(4.*x-1).*(8.*x+8.*y-7)
            16/3.*x.*(4.*x-1).*(2.*x-1)
            -128.*y.^2.*x-512/3.*y.^3+224.*y.^2+64.*y.*x-224/3.*y-16/3.*x+16/3
            -16/3.*x.*(24.*x.^2+48.*y.*x-36.*x+24.*y.^2-36.*y+13)
            16/3.*x.*(24.*y.^2-12.*y+1)
            16-208/3.*x-416/3.*y+384.*y.*x-256.*y.*x.^2-512/3.*y.^3-128/3.*x.^3+96.*x.^2+288.*y.^2-384.*y.^2.*x
            -16/3.*x.*(4.*x-1).*(2.*x-1)
            32.*x.*(4.*x.^2+16.*y.*x-7.*x+12.*y.^2-14.*y+3)
            -32.*x.*(4.*x-1).*(x+2.*y-1)
            -32.*x.*(8.*y.*x+12.*y.^2-10.*y-x+1)].';
    case 5
        psi = [
            -625/24.*(x+y-1).*(x+y-4/5).*(x+y-3/5).*(x+y-2/5).*(x+y-1/5)
            625/24.*x.*(x-1/5).*(x-2/5).*(x-3/5).*(x-4/5)
            625/24.*y.*(y-1/5).*(y-2/5).*(y-3/5).*(y-4/5)
            3125/24.*x.*(x-1/5).*(x-2/5).*(x-3/5).*y
            -3125/24.*y.*(y-1/5).*(y-2/5).*(y-3/5).*(x+y-1)
            3125/24.*(x+y-1).*(x+y-4/5).*(x+y-3/5).*(x+y-2/5).*x
            3125/12.*x.*(x-1/5).*(x-2/5).*y.*(y-1/5)
            3125/12.*y.*(y-1/5).*(y-2/5).*(x+y-1).*(x+y-4/5)
            -3125/12.*(x+y-1).*(x+y-4/5).*(x+y-3/5).*x.*(x-1/5)
            3125/12.*x.*(x-1/5).*y.*(y-1/5).*(y-2/5)
            -3125/12.*y.*(y-1/5).*(x+y-1).*(x+y-4/5).*(x+y-3/5)
            3125/12.*(x+y-1).*(x+y-4/5).*x.*(x-1/5).*(x-2/5)
            3125/24.*x.*y.*(y-1/5).*(y-2/5).*(y-3/5)
            3125/24.*y.*(x+y-1).*(x+y-4/5).*(x+y-3/5).*(x+y-2/5)
            -3125/24.*(x+y-1).*x.*(x-1/5).*(x-2/5).*(x-3/5)
            -3125/6.*x.*y.*(x+y-1).*(x+y-4/5).*(x+y-3/5)
            -3125/6.*x.*y.*(x+y-1).*(x-1/5).*(x-2/5)
            -3125/6.*x.*y.*(x+y-1).*(y-1/5).*(y-2/5)
            -3125/4.*x.*(x-1/5).*y.*(y-1/5).*(x+y-1)
            3125/4.*y.*(y-1/5).*(x+y-1).*(x+y-4/5).*x
            3125/4.*(x+y-1).*(x+y-4/5).*x.*(x-1/5).*y].';
        
        psi_x = [
            375/4.*x+375/4.*y-2125/8.*x.^2-3125/6.*y.*x.^3-2125/4.*y.*x-2125/8.*y.^2+1875/2.*x.*y.^2-3125/4.*x.^2.*y.^2-3125/6.*x.*y.^3+625/2.*x.^3+625/2.*y.^3+1875/2.*y.*x.^2-3125/24.*x.^4-3125/24.*y.^4-137/12
            1+3125/24.*x.^4-625/3.*x.^3+875/8.*x.^2-125/6.*x
            zeroRow
            25/12.*y.*(10.*x-3).*(25.*x.^2-15.*x+1)
            -25/24.*y.*(5.*y-1).*(5.*y-2).*(5.*y-3)
            25-1925/6.*x-1925/12.*y+8875/8.*x.^2+6250/3.*y.*x.^3+8875/6.*y.*x+8875/24.*y.^2-4375/2.*x.*y.^2+9375/4.*x.^2.*y.^2+3125/3.*x.*y.^3-4375/3.*x.^3-4375/12.*y.^3-13125/4.*y.*x.^2+15625/24.*x.^4+3125/24.*y.^4
            25/12.*y.*(75.*x.^2-30.*x+2).*(5.*y-1)
            25/12.*y.*(5.*y-1).*(5.*y-2).*(10.*y+10.*x-9)
            -25+2675/6.*x+1175/12.*y-7375/4.*x.^2-3125.*y.*x.^3-8875/6.*y.*x-125.*y.^2+3125/2.*x.*y.^2-9375/4.*x.^2.*y.^2-3125/6.*x.*y.^3+8125/3.*x.^3+625/12.*y.^3+16875/4.*y.*x.^2-15625/12.*x.^4
            25/12.*y.*(5.*y-1).*(5.*y-2).*(10.*x-1)
            -25/12.*y.*(5.*y-1).*(75.*y.^2+150.*y.*x-120.*y+47+75.*x.^2-120.*x)
            -325.*x-75/2.*y+6125/4.*x.^2+6250/3.*y.*x.^3+3875/6.*y.*x+125/6.*y.^2-625/2.*x.*y.^2+3125/4.*x.^2.*y.^2-2500.*x.^3-9375/4.*y.*x.^2+15625/12.*x.^4+50/3
            25/24.*y.*(5.*y-1).*(5.*y-2).*(5.*y-3)
            25/12.*y.*(10.*x-7+10.*y).*(25.*x.^2+50.*y.*x-35.*x+11-35.*y+25.*y.^2)
            1525/12.*x+25/4.*y-5125/8.*x.^2-3125/6.*y.*x.^3-1375/12.*y.*x+6875/6.*x.^3+1875/4.*y.*x.^2-15625/24.*x.^4-25/4
            -125/6.*y.*(-12+100.*x.^3+94.*x+47.*y-240.*y.*x+225.*y.*x.^2+150.*x.*y.^2-60.*y.^2-180.*x.^2+25.*y.^3)
            -125/6.*y.*(100.*x.^3-120.*x.^2+34.*x+75.*y.*x.^2-30.*y.*x+2.*y-2)
            -125/6.*y.*(5.*y-1).*(5.*y-2).*(y+2.*x-1)
            -125/4.*y.*(5.*y-1).*(10.*y.*x-y-12.*x+15.*x.^2+1)
            125/4.*y.*(5.*y-1).*(5.*y.^2+20.*y.*x-9.*y-18.*x+4+15.*x.^2)
            125/4.*y.*(y+2.*x-1).*(50.*y.*x-5.*y+4+50.*x.^2-50.*x)].';
        
        psi_y = [
            1875/2.*x.^2.*y+375/4.*x+375/4.*y-2125/8.*y.^2-3125/6.*x.*y.^3-3125/4.*x.^2.*y.^2-3125/6.*x.^3.*y+1875/2.*x.*y.^2-2125/4.*x.*y-2125/8.*x.^2-3125/24.*x.^4+625/2.*x.^3-3125/24.*y.^4+625/2.*y.^3-137/12
            zeroRow
            3125/24.*y.^4-625/3.*y.^3+875/8.*y.^2-125/6.*y+1
            25/24.*x.*(5.*x-1).*(5.*x-2).*(5.*x-3)
            25/4.*x+1525/12.*y-5125/8.*y.^2-25/4-3125/6.*x.*y.^3+1875/4.*x.*y.^2-1375/12.*x.*y-15625/24.*y.^4+6875/6.*y.^3
            25/12.*x.*(10.*x-7+10.*y).*(25.*x.^2+50.*x.*y-35.*x-35.*y+25.*y.^2+11)
            25/12.*x.*(5.*x-1).*(5.*x-2).*(10.*y-1)
            -625/2.*x.^2.*y-75/2.*x-325.*y+6125/4.*y.^2+6250/3.*x.*y.^3+3125/4.*x.^2.*y.^2-9375/4.*x.*y.^2+3875/6.*x.*y+125/6.*x.^2+15625/12.*y.^4-2500.*y.^3+50/3
            -25/12.*x.*(5.*x-1).*(75.*x.^2+150.*x.*y-120.*x+75.*y.^2-120.*y+47)
            25/12.*x.*(-30.*y+75.*y.^2+2).*(5.*x-1)
            -25+3125/2.*x.^2.*y+1175/12.*x+2675/6.*y-7375/4.*y.^2-3125.*x.*y.^3-9375/4.*x.^2.*y.^2-3125/6.*x.^3.*y+16875/4.*x.*y.^2-8875/6.*x.*y-125.*x.^2+625/12.*x.^3-15625/12.*y.^4+8125/3.*y.^3
            25/12.*x.*(5.*x-1).*(5.*x-2).*(10.*x+10.*y-9)
            25/12.*x.*(10.*y-3).*(25.*y.^2-15.*y+1)
            25-4375/2.*x.^2.*y-1925/12.*x-1925/6.*y+8875/8.*y.^2+6250/3.*x.*y.^3+9375/4.*x.^2.*y.^2+3125/3.*x.^3.*y-13125/4.*x.*y.^2+8875/6.*x.*y+8875/24.*x.^2+3125/24.*x.^4-4375/12.*x.^3+15625/24.*y.^4-4375/3.*y.^3
            -25/24.*x.*(5.*x-1).*(5.*x-2).*(5.*x-3)
            -125/6.*x.*(-240.*x.*y-12+100.*y.^3+225.*x.*y.^2+150.*x.^2.*y-180.*y.^2+94.*y+47.*x+25.*x.^3-60.*x.^2)
            -125/6.*x.*(5.*x-1).*(5.*x-2).*(x+2.*y-1)
            -125/6.*x.*(75.*x.*y.^2+100.*y.^3-120.*y.^2-30.*x.*y+34.*y+2.*x-2)
            -125/4.*x.*(5.*x-1).*(10.*x.*y+15.*y.^2-12.*y-x+1)
            125/4.*x.*(x+2.*y-1).*(50.*x.*y-5.*x+50.*y.^2+4-50.*y)
            125/4.*x.*(5.*x-1).*(20.*x.*y+15.*y.^2-18.*y+5.*x.^2-9.*x+4)].';
        
    otherwise
        disp(['Only have Lagrange element of degree 1, 2, 3, 4 and 5']);
        return
end

psi = round(psi*10^13)*(10^(-13));
psi_x = round(psi_x*10^13)*(10^(-13));
psi_y = round(psi_y*10^13)*(10^(-13));
